<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PadelMaster - Gesti√≥n de Turnos</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { 
      font-family: 'Inter', sans-serif; 
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
    }
    .container { max-width: 1200px; margin: 0 auto; }
    header { text-align: center; color: white; margin-bottom: 40px; padding: 20px; }
    h1 { font-size: 2.5em; margin-bottom: 10px; }
    .subtitle { font-size: 1.1em; opacity: 0.9; }
    .main-content { display: grid; grid-template-columns: 1fr 1fr; gap: 30px; }
    .card { 
      background: white; border-radius: 10px; padding: 30px; 
      box-shadow: 0 10px 30px rgba(0,0,0,0.2);
    }
    .card h2 { color: #667eea; margin-bottom: 20px; }
    .form-group { margin-bottom: 20px; }
    label { display: block; margin-bottom: 8px; color: #333; font-weight: 500; }
    input, select { width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 5px; font-size: 1em; }
    input:focus, select:focus { outline: none; border-color: #667eea; }
    button { width: 100%; padding: 15px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; border-radius: 5px; font-size: 1.1em; font-weight: 600; cursor: pointer; }
    button:hover { transform: translateY(-2px); box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4); }
    .schedule-items { margin-top: 20px; }
    .schedule-item { padding: 15px; background: #f5f5f5; border-left: 4px solid #667eea; margin-bottom: 10px; border-radius: 5px; }
    .schedule-item strong { color: #667eea; }
    .success-message { background: #4caf50; color: white; padding: 15px; border-radius: 5px; margin-bottom: 20px; display: none; }
    .info-message { background: #2196F3; color: white; padding: 15px; border-radius: 5px; margin-bottom: 20px; text-align: center; }
    @media (max-width: 768px) {
      .main-content { grid-template-columns: 1fr; }
      h1 { font-size: 1.8em; }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>üéæ PadelMaster</h1>
      <p class="subtitle">Gesti√≥n de Turnos de P√°del - San Carlos de Bol√≠var</p>
    </header>
    <div class="main-content">
      <div class="card">
        <h2>üìÖ Reservar Turno</h2>
        <div class="info-message">üîê Pago seguro con Mercado Pago</div>
        <form id="reservaForm" onsubmit="procederAlPago(event)">
          <div class="form-group">
            <label>Nombre Completo *</label>
            <input type="text" id="nombre" placeholder="Tu nombre" required>
          </div>
          <div class="form-group">
            <label>Email *</label>
            <input type="email" id="email" placeholder="tu@email.com" required>
          </div>
          <div class="form-group">
            <label>Tel√©fono (WhatsApp) *</label>
            <input type="tel" id="telefono" placeholder="+54 9 XXX XXXXXXX" required>
          </div>
          <div class="form-group">
            <label>Cancha *</label>
            <select id="cancha" required>
              <option value="">-- Selecciona una cancha --</option>
              <option>Cancha 1 - Interior (LED)</option>
              <option>Cancha 2 - Interior (LED)</option>
              <option>Cancha 3 - Exterior (Piso Sint√©tico)</option>
              <option>Cancha 4 - Exterior (Piso Sint√©tico)</option>
            </select>
          </div>
          <div class="form-group">
            <label>Fecha *</label>
            <input type="date" id="fecha" required>
          </div>
          <div class="form-group">
            <label>Hora Inicio *</label>
            <select id="hora" required>
              <option value="">-- Selecciona horario --</option>
              <option>08:00</option>
              <option>09:30</option>
              <option>11:00</option>
              <option>12:30</option>
              <option>14:00</option>
              <option>15:30</option>
              <option>17:00</option>
              <option>18:30</option>
              <option>20:00</option>
            </select>
          </div>
          <div class="form-group">
            <label>Duraci√≥n *</label>
            <select id="duracion" required onchange="actualizarPrecio()">
              <option value="">-- Selecciona duraci√≥n --</option>
              <option value="60">60 minutos - $400</option>
              <option value="90">90 minutos - $550</option>
              <option value="120">120 minutos - $700</option>
            </select>
          </div>
          <div class="form-group">
            <label>Cantidad de Jugadores *</label>
            <select id="jugadores" required>
              <option value="">-- Selecciona cantidad --</option>
              <option>2 Jugadores</option>
              <option>3 Jugadores</option>
              <option>4 Jugadores</option>
            </select>
          </div>
          <div class="form-group" style="background: #f5f5f5; padding: 15px; border-radius: 5px; font-weight: 600; text-align: center;">
            Costo Total: $<span id="precioTotal">400</span>
          </div>
          <button type="submit">üîó Proceder al Pago</button>
        </form>
      </div>
      <div class="card">
        <h2>üìã Pr√≥ximos Turnos</h2>
        <div class="schedule-items" id="scheduleItems">
          <p style="color: #999; text-align: center; padding: 20px;">A√∫n no hay turnos confirmados</p>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Configuraci√≥n
    const precios = { 60: 400, 90: 550, 120: 700 };
    const MERCADO_PAGO_URL = 'https://www.mercadopago.com.ar';

    // Establecer fecha m√≠nima a hoy
    const today = new Date().toISOString().split('T')[0];
    document.getElementById('fecha').setAttribute('min', today);

    // Actualizar precio
    function actualizarPrecio() {
      const duracion = document.getElementById('duracion').value;
      const precio = precios[duracion] || 400;
      document.getElementById('precioTotal').textContent = precio;
    }

    // Proceder al pago
    function procederAlPago(e) {
      e.preventDefault();

      const datos = {
        nombre: document.getElementById('nombre').value,
        email: document.getElementById('email').value,
        telefono: document.getElementById('telefono').value,
        cancha: document.getElementById('cancha').value,
        fecha: document.getElementById('fecha').value,
        hora: document.getElementById('hora').value,
        duracion: document.getElementById('duracion').value,
        jugadores: document.getElementById('jugadores').value,
        precio: precios[document.getElementById('duracion').value]
      };

      // Guardar en localStorage
      localStorage.setItem('ultima_reserva', JSON.stringify(datos));
      localStorage.setItem('timestamp', new Date().toISOString());

      // Crear descripci√≥n del pago
      const descripcion = `Reserva - ${datos.cancha} - ${datos.fecha} ${datos.hora}`;
      const referencia = `turno_${Date.now()}`;

      // Construir URL para Mercado Pago (enlace de pago r√°pido)
      // Usando el nuevo sistema de checkouts de Mercado Pago
      const urlPago = `${MERCADO_PAGO_URL}/checkout/v1/redirect?pref_id=turno_${datos.email.replace(/@.*/, '')}_${Date.now()}`;

      // Mostrar mensaje y redirigir
      alert(`‚úÖ Reserva guardada!\n\nNombre: ${datos.nombre}\nFecha: ${datos.fecha}\nHora: ${datos.hora}\nPrecio: $${datos.precio}\n\nSer√°s redirigido a Mercado Pago para completar el pago.`);

      // Redirigir a Mercado Pago (en una aplicaci√≥n real, esto vendr√≠a del servidor)
      // Por ahora, abrimos la p√°gina principal de Mercado Pago
      window.location.href = 'https://www.mercadopago.com.ar/checkout?preference_id=turno_padel_' + Date.now();
    }

    // Cargar turnos al iniciar
    function cargarTurnos() {
      const reservas = JSON.parse(localStorage.getItem('reservas_confirmadas')) || [];
      const container = document.getElementById('scheduleItems');
      
      if (reservas.length === 0) {
        container.innerHTML = '<p style="color: #999; text-align: center; padding: 20px;">A√∫n no hay turnos confirmados</p>';
        return;
      }

      container.innerHTML = reservas.map(r => 
        `<div class="schedule-item"><strong>${r.cancha}</strong> - ${r.fecha} ${r.hora}<br>üë§ ${r.nombre}<br>‚è±Ô∏è ${r.duracion} min - ${r.jugadores}</div>`
      ).join('');
    }

    cargarTurnos();
  </script>
</body>
</html>
